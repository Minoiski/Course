\chapter{ОСНОВНЫЕ ПОНЯТИЯ И ОБЗОР ЛИТЕРАТУРЫ }\label{chap1}






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Теория управления по прогнозирующей модели}\label{1sec:MPC}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

В западной литературе управление в реальном времени представлено теорией управления по прогнозирующей модели --- Model Predictive Control (MPC), также называемая Receding Horizon Control (RHC). Основными приложениями теории являются задачи стабилизации динамических систем. Современная теория нелинейного MPC предлагает основанные на решении задач оптимального управления методы построения обратных связей для нелинейных объектов.

Главная идея MPC --- использование математической модели управляемого процесса в пространстве состояний для предсказания и оптимизации будущего поведения системы. Поясним на примере модели нелинейного процесса управления
\begin{equation}\label{sys2}
    \dot x = f(x,u)
    \end{equation}
где $x=x(t)\in \mathbb{R}^n$ --- состояние модели  в момент времени $t$; $u=u(t)\in
\mathbb{R}^r$ --- значение управляющего воздействия; $f:\mathbb{R}^n \to \mathbb{R}^r$ --- заданная функция, обеспечивающая существование и единственность решения (\ref{sys2}) при любом допустимом управляющем воздействии.

Нелинейное управление по прогнозирующей модели
Нелинейное управление по прогнозирующей модели — это оптимизационный метод для управления по обратной связи нелинейных систем. Его основные приложения — это [стабилизационная задача и задача отслеживания?? stabilization and tracking problems].
Предположим, что нам дан контролируемый процесс, состояние которого x(n) измеряется в дискретные моменты времени $t_n$ $n=0, 1 \dots$ 
«Контролируемый» означает, что в каждый момент времени мы можем выбрать управляющее воздействие u(n), которое влияет на будущее поведение состояния системы. В [следящем?? tracking] управлении задача состоит в том, чтобы определить управляющее воздействие u(n) таким образом, чтобы x(n) следовало заданному эталону $x^{ref}(n)$ настолько точно, насколько это возможно. Это значит, что если текущее состояние далеко от эталонного, то мы должны управлять системой в направлении эталонного состояния, а если текущее состояние уже близко к эталону, то мы стараемся удержать его там. Для простоты будем считать, $x(n)\in  X = R^d$ и $u(n)\in U = R^m$, более того считаем эталон константой и равным $x_*= 0$, т.е, $x^{ref}(n) = x_* = 0$ для всех $n \geqslant 0$. С таким константным эталоном задача отслеживания упрощается до задачи стабилизации.
Так как мы хотим иметь возможность влиять на отклонение x(n) от эталонного значения $x_* = 0$, нам бы хотелось иметь u(n) в [обратном? feedback] виде, т.е. в виде $u(n) =\mu(x(n))$, где некоторое отображение ? отображает состояние $x \in X$ во множество значений управления U.
Идея управления по прогнозирующей модели — как использовать модель процесса с целью предсказания и оптимизации будущего поведения системы. Будем рассматривать модели вида
$x^+ = f (x, u)$                                                                                                        (1.1)
 где $f: X \times U \to X$ это известная, вообще говоря, нелинейная функция, которая ставит в соответствие состоянию x и значению управления u [последовательное значение? successor state] $x^+$ в следующий момент времени. Начиная с текущего состояния x(n), для любой последовательности управлений $u(0), \dots , u(N ?1)$ с длиной горизонта $N \geqslant 2$, мы можем совершать итерации (1.1) с целью составления прогнозируемой траектории $x_u$ определённой как
$x_u(0) = x(n)$, $x_u(k + 1) = f (x_u(k), u(k)), k = 0, \dots , N - 1$                                                        (1.2)       
Этим способом мы получаем прогнозы $x_u(k)$ для состояния системы x(n+k) в момент времени $t_{n+k}$ в будущем. Таким образом, мы получаем прогноз поведения системы на дискретном интервале $t_n, \dots , t_{n+N}$ в зависимости от выбранной последовательности управлений $u(0), \dots , u(N - 1)$.
Теперь мы используем оптимальное управление для определения $u(0), \dots , u(N - 1)$ таким образом, чтобы $x_u$ было как можно ближе к $x_* = 0$. С этой целью мы измеряем расстояние между $x_u(k)$ и $x_* = 0$ для $k = 0, \dots , N - 1$ с помощью функции  $\ell(x_u(k), u(k))$. То есть мы не только вводим штраф за отклонение состояния от эталона, но также – если хотим – расстояние значений управления u(k) до эталонного управления $u_*$, которое мы здесь также выбираем $u_*$=0. Стандартныйи популярный выбор для этой цели – это квадратичная функция
$\ell(x_u(k), u(k)) =  ||xu(k)||^2 + \lambda||u(k)||^2$
где || . || обозначает обычную Евклидову норму, а $\lambda \geqslant 0$ это весовой параметр управления, который также может быть принят равным 0, если мы желаем вводить штраф. Теперь задача оптимального управления выглядит так: 

minimize $J(x(n),u(.)):= \sum_{k=0}^{N-1}\ell(x_u(k), u(k))$

Для всех допустимых последовательностей управления $u(0), \dots, u(N - 1)$ с $x_u$ вычисленными по формулам (1.2).
Будем считать, что ЗОУ имеет решение, которое получается в результате минимизации последовательности управлений u*(0), \dots , u*(N - 1), то есть

$\min J(x(n),u(.)) =  \sum_{k=0}^{N-1}\ell(x_{u^*}(k), u^*(k))$


 Чтобы получить желаемое значение величины обратной связи $\mu(x(n))$, мы теперь устанавливаем $\mu(x(n)):= u^*(0)$, то есть, мы используем первый элемент последовательности оптимальных управлений.
В следующие моменты времени $t_{n+1}, t_{n+2}, \dots$ мы повторяем процедуру с новыми измерениями $x(n + 1), x(n + 2), \dots$ с целью получения переменных обратной связи $\mu(x(n + 1)), \mu(x(n + 2)), \dots $ Другими словами, мы получаем закон обратной связи $\mu$ с помощью итерационной онлайн оптимизации над прогнозами, полученными с помощью нашей модели (1.1). Это первая ключевая характеристика управления по прогнозирующей модели.


С точки зрения горизонта планирования, при выполнение этих итераций, траектории $x_u (k), k = 0,\dots N$ обеспечивают прогноз на дискретном интервале $t_n,\dots t_{n + N}$ в момент времени $t_n$, на интервале $t_{n + 1},\dots t_{n + N + 1}$ в момент времени $t_{n + 1}$, на интервале $t_{n + 2},\dots t_{n+N+2}$ в момент времени $t_{n + 2}$ и т. д. Следовательно, горизонт планирования движется, и этот движущийся горизонт является второй ключевой характеристикой управления по прогнозирующей модели.

\section{Экономический MPC}\label{1sec:EMPC}
Экономический MPC это вид MPC, в котором, в отличие от обычного, задача управления не обязательно связана со стабилизацией априори заданной точки [значения?] (или траектории), а с оптимизацией некоторого общего критерия эффективности, возможно относящегося к экономике рассматриваемой системы. В связи с использованием общего критерия эффективности оптимальный режим работы рассматриваемой системы может быть не стационарным, а циклическим или даже более сложным. Отсюда возникает вопрос, как узнать, каков оптимальный режим работы данной системы и данной функции стоимости. Более того, желательно гарантировать, чтобы замкнутая система [система с обратной связью???] возникающая в результате применения схемы экономического MPC, «находила» оптимальное рабочее поведение, то есть сходилась к оптимальной траектории.
\section{Задачи оптимального управления}\label{1sec:ZOU}
\section{Численные методы решения задач оптимального управления и программные средства}\label{1sec:Zou}